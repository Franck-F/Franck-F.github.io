<!DOCTYPE html>
<html lang="fr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automatisation des Processus Métier</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: "Bert Consultant" - Un fond blanc cassé avec le bleu sarcelle (#00A99D) et le violet foncé (#3F2A56) du logo comme couleurs primaires et secondaires. -->
    <!-- Application Structure Plan: L'application est conçue comme un tableau de bord stratégique en 4 sections, guidant l'utilisateur de la problématique à la solution. 1) 'Diagnostic' expose le flux de travail inefficace actuel. 2) 'Explorateur de Processus' permet une immersion interactive dans chaque processus via des cartes filtrables. 3) 'Analyse des Frictions' agrège et visualise les problèmes récurrents et les synergies entre processus pour en souligner l'impact systémique. 4) 'La Solution IA' présente l'architecture d'agents IA proposée de manière visuelle et compréhensible. Cette structure non-linéaire transforme le rapport statique en un outil d'exploration et de prise de décision. -->
    <!-- Visualization & Content Choices: 1. Diagnostic (Flux actuel): Diagramme HTML/CSS simple (Goal: Informer). 2. Priorités d'Automatisation: Graphique en anneau Chart.js avec légende HTML détaillée (Goal: Comparer & Informer). 3. Frictions Systémiques: Diagramme à bulles Chart.js pour montrer la fréquence et l'impact (Goal: Analyser & Prioriser). 4. Matrice de Similitude: Tableau interactif (HTML Table) avec coloration de type heatmap (Goal: Explorer & Analyser). 5. Architecture de la Solution: Cartes stratégiques interactives pour comparer les options technologiques pour chaque pôle de la solution (Goal: Expliquer & Comparer). -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F9FAFB; /* Light gray background */
            color: #374151; /* Darker gray text */
        }
        :root {
            --primary-color: #00A99D; /* Teal */
            --secondary-color: #3F2A56; /* Dark Purple */
        }
        .nav-link {
            position: relative;
            transition: color 0.3s;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -4px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--primary-color);
            transition: width 0.3s;
        }
        .nav-link:hover::after, .nav-link.active::after {
            width: 100%;
        }
        .card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }
        .tag-red { background-color: #FECACA; color: #991B1B; }
        .tag-orange { background-color: #FDE68A; color: #92400E; }
        .tag-blue { background-color: #BFDBFE; color: #1E40AF; }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        
        .interactive-table-container {
            max-width: 900px;
            margin: auto;
        }
        .interactive-table {
            border-collapse: collapse;
            width: 100%;
            font-size: 0.8rem;
        }
        .interactive-table th, .interactive-table td {
            border: 1px solid #E2E8F0;
            padding: 0.5rem;
            text-align: center;
            position: relative;
        }
        .interactive-table th {
            background-color: #F8FAFC;
            font-weight: 600;
            white-space: nowrap;
            transition: background-color 0.2s;
        }
        .interactive-table th.col-header {
            writing-mode: vertical-rl;
            text-orientation: mixed;
            transform: rotate(180deg);
            padding: 0.75rem 0.25rem;
        }
        .interactive-table th.highlight, .interactive-table td.highlight-strong {
            background-color: #A7F3D0; /* Light Teal */
        }
         .interactive-table td.highlight-weak {
            background-color: #E0E7FF; /* Light purple */
         }
         .interactive-table td {
            transition: background-color 0.2s;
         }
        .interactive-table td .tooltip {
            visibility: hidden;
            width: 80px;
            background-color: var(--secondary-color);
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 0;
            position: absolute;
            z-index: 20;
            bottom: 110%;
            left: 50%;
            margin-left: -40px;
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: none;
        }
         .interactive-table td:hover .tooltip {
            visibility: visible;
            opacity: 1;
        }
        .workflow-step {
            display: flex;
            align-items: center;
            opacity: 0;
            transform: translateX(-20px);
            transition: opacity 0.4s ease, transform 0.4s ease;
        }
        .workflow-step.visible {
            opacity: 1;
            transform: translateX(0);
        }
        .workflow-icon-container {
            flex-shrink: 0;
            width: 2.5rem;
            height: 2.5rem;
            margin-right: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .workflow-arrow {
            text-align: center;
            color: #D1D5DB; /* gray-300 */
            font-size: 1.5rem;
            height: 2rem;
            opacity: 0;
            transition: opacity 0.4s ease 0.2s;
        }
        .workflow-arrow.visible {
            opacity: 1;
        }
        /* Animated Icons CSS */
        .icon-scan {
            width: 24px; height: 28px; background-color: #A7F3D0; border: 2px solid var(--primary-color); border-radius: 2px; position: relative; overflow: hidden;
        }
        .icon-scan::before {
            content: ''; position: absolute; left: 0; top: 0; width: 100%; height: 2px; background-color: var(--primary-color); animation: scan 1.5s ease-in-out infinite;
        }
        @keyframes scan {
            0% { top: 0; }
            50% { top: 26px; }
            100% { top: 0; }
        }
        .icon-check {
            width: 28px; height: 28px; border: 2px solid var(--primary-color); border-radius: 50%; display: flex; align-items: center; justify-content: center;
        }
        .icon-check .checkmark-stem { width: 3px; height: 0; background-color: var(--primary-color); transform: rotate(45deg); transition: height 0.2s ease-out 0.3s; }
        .icon-check .checkmark-kick { width: 0; height: 3px; background-color: var(--primary-color); transform: rotate(45deg); transition: width 0.2s ease-out; }
        .visible .icon-check .checkmark-stem { height: 14px; }
        .visible .icon-check .checkmark-kick { width: 8px; transform: translate(-1px, -1px) rotate(45deg); }
        .icon-write {
            width: 24px; height: 28px; background-color: #FEF3C7; border: 2px solid #FBBF24; border-radius: 2px; position: relative;
        }
        .icon-write::before { content: ''; position: absolute; top: 8px; left: 4px; width: 2px; height: 12px; background: #FBBF24; animation: typing 1s infinite; }
        @keyframes typing {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        .icon-grid {
            width: 24px; height: 24px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px;
        }
        .icon-grid .cell { background-color: #E0E7FF; transition: background-color 0.2s; }
        .visible .icon-grid .cell:nth-child(1) { transition-delay: 0.1s; background-color: #6366F1; }
        .visible .icon-grid .cell:nth-child(2) { transition-delay: 0.2s; background-color: #6366F1; }
        .visible .icon-grid .cell:nth-child(3) { transition-delay: 0.3s; background-color: #6366F1; }
        .visible .icon-grid .cell:nth-child(4) { transition-delay: 0.4s; background-color: #6366F1; }
        .icon-graph {
            width: 28px; height: 24px; display: flex; align-items: flex-end; justify-content: space-around;
        }
        .icon-graph .bar { background-color: var(--secondary-color); width: 6px; height: 0; transition: height 0.4s ease-in-out; }
        .visible .icon-graph .bar:nth-child(1) { height: 60%; transition-delay: 0.1s; }
        .visible .icon-graph .bar:nth-child(2) { height: 90%; transition-delay: 0.2s; }
        .visible .icon-graph .bar:nth-child(3) { height: 40%; transition-delay: 0.3s; }

        .pole-card {
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        .pole-card.active {
            border-color: var(--primary-color);
            box-shadow: 0 10px 15px -3px rgba(0, 169, 157, 0.2), 0 4px 6px -2px rgba(0, 169, 157, 0.1);
            transform: translateY(-5px);
        }
        .solution-details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.7s ease-in-out, padding 0.5s ease, margin 0.5s ease, opacity 0.5s ease;
            padding-top: 0;
            padding-bottom: 0;
            margin-top: 0;
            opacity: 0;
        }
        .solution-details.show {
            max-height: 2000px; /* Large enough to fit content */
            padding-top: 1.5rem;
            padding-bottom: 1.5rem;
            margin-top: 1rem;
            opacity: 1;
        }
        .solution-title {
            font-weight: 700;
            color: var(--primary-color);
        }
        .solution-table dt {
            font-weight: 600;
            color: var(--secondary-color);
        }
        .n8n-architecture {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 2rem;
            align-items: center;
            min-height: 400px;
            position: relative;
        }
        .n8n-col {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            align-items: center;
        }
        .n8n-node {
            background-color: white;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            border: 1px solid #E5E7EB;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            text-align: center;
            font-size: 0.8rem;
            font-weight: 500;
            position: relative;
            cursor: help;
        }
        .n8n-node-main {
             background-color: var(--secondary-color);
             color: white;
             padding: 1.5rem;
             border-color: var(--secondary-color);
        }
        .n8n-node-agent {
            border-left: 4px solid var(--primary-color);
        }
        .n8n-arrow {
            position: absolute;
            opacity: 0;
            stroke: var(--secondary-color);
            stroke-width: 2;
            fill: none;
            animation: draw-arrow 0.5s ease-out forwards;
        }
        @keyframes draw-arrow {
            to { opacity: 1; }
        }
        .has-tooltip:hover .tooltip-content {
            display: block;
        }
        .tooltip-content {
            display: none;
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-10px);
            background-color: #374151;
            color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            width: 200px;
            z-index: 10;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-lg sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <img src="logo-bert-consultant-xs.jpg" alt="Logo Bert Consultant" class="h-12">
            <ul class="flex space-x-8">
                <li><a href="#diagnostic" class="nav-link text-gray-600 hover:text-gray-900">Diagnostic</a></li>
                <li><a href="#explorer" class="nav-link text-gray-600 hover:text-gray-900">Explorateur</a></li>
                <li><a href="#analyse" class="nav-link text-gray-600 hover:text-gray-900">Analyse</a></li>
                <li><a href="#solution" class="nav-link text-gray-600 hover:text-gray-900">La Solution</a></li>
                <li><a href="#redaction" class="nav-link text-gray-600 hover:text-gray-900">Rédaction de contrat</a></li>
            </ul>
        </nav>
    </header>

    <main class="container mx-auto px-6 py-12">

        <section id="diagnostic" class="text-center py-16">
            <h1 class="text-4xl font-bold mb-4 text-gray-300">Automatisation des processus métiers</h1>
            <h2 class="text-4xl font-bold mb-4 text-gray-800">Le Constat</h2>
            <p class="max-w-3xl mx-auto text-lg text-gray-600 mb-12">
                L'analyse des processus révèle une dépendance à une "trinité documentaire" (PDF, Excel, Word) .
            </p>
            <div class="flex flex-col md:flex-row items-center justify-center space-y-8 md:space-y-0 md:space-x-4">
                <div class="bg-white p-6 rounded-xl shadow-md text-center w-64">
                    <div class="text-4xl mb-3">📄</div>
                    <h3 class="text-lg font-semibold text-gray-800">PDF & Scans</h3>
                    <p class="text-sm text-gray-500">Documents d'entrée non structurés et parfois illisibles</p>
                </div>
                <div class="text-2xl text-gray-300 mx-4 hidden md:block">→</div>
                <div class="bg-white p-6 rounded-xl shadow-md text-center w-64">
                    <div class="text-4xl mb-3">📊</div>
                    <h3 class="text-lg font-semibold text-gray-800">Excel</h3>
                    <p class="text-sm text-gray-500">Saisie manuelle & silos de données</p>
                </div>
                <div class="text-2xl text-gray-300 mx-4 hidden md:block">→</div>
                <div class="bg-white p-6 rounded-xl shadow-md text-center w-64">
                    <div class="text-4xl mb-3">📝</div>
                    <h3 class="text-lg font-semibold text-gray-800">Word & PPT</h3>
                    <p class="text-sm text-gray-500">Rapports finaux manuels</p>
                </div>
            </div>
            <p class="max-w-3xl mx-auto text-md text-gray-600 mt-12">
                Ce cycle manuel est non seulement chronophage mais constitue un risque opérationnel majeur. La solution n'est pas d'accélérer ce cycle, mais de le réinventer en s'attaquant à sa racine : l'architecture de données fragmentée.
            </p>
        </section>

        <section id="explorer" class="py-16">
            <h2 class="text-4xl font-bold text-center mb-4 text-gray-800">Explorateur des Processus Métier</h2>
            <p class="max-w-3xl mx-auto text-lg text-gray-600 mb-12 text-center">
                Plongez au cœur des opérations. Chaque processus a été analysé pour identifier son flux, ses outils et ses points faibles. Utilisez les filtres pour naviguer et cliquez sur une carte pour afficher les détails.
            </p>

            <div class="flex justify-center mb-8 space-x-2" id="filters">
                <button class="filter-btn active text-white px-4 py-2 rounded-full font-semibold" style="background-color: var(--secondary-color);">Tous</button>
                <button class="filter-btn bg-gray-200 text-gray-800 px-4 py-2 rounded-full font-semibold" data-filter="Audit">Audit & Contrôle</button>
                <button class="filter-btn bg-gray-200 text-gray-800 px-4 py-2 rounded-full font-semibold" data-filter="Gestion">Gestion Contractuelle</button>
                <button class="filter-btn bg-gray-200 text-gray-800 px-4 py-2 rounded-full font-semibold" data-filter="Analyse">Analyse & Décision</button>
                <button class="filter-btn bg-gray-200 text-gray-800 px-4 py-2 rounded-full font-semibold" data-filter="Étude">Études & Finances</button>
            </div>

            <div id="process-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
            </div>

            <div id="process-detail" class="hidden mt-12 bg-white p-8 rounded-xl shadow-lg">
                <button id="close-detail" class="float-right font-bold text-2xl text-gray-500 hover:text-gray-800">&times;</button>
                <h3 id="detail-title" class="text-2xl font-bold text-gray-800 mb-2"></h3>
                <div class="space-x-2 mb-4">
                    <span id="detail-category" class="tag"></span>
                    <span id="detail-priority" class="tag"></span>
                </div>
                <p id="detail-description" class="text-gray-600 mb-6"></p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <h4 class="font-semibold text-lg mb-3 text-gray-800">Flux de Travail :</h4>
                        <div id="detail-workflow" class="space-y-2"></div>
                    </div>
                    <div>
                        <h4 class="font-semibold text-lg mb-3 text-gray-800">Points de Friction :</h4>
                        <ul id="detail-painpoints" class="list-disc list-inside space-y-2 text-red-700"></ul>
                    </div>
                </div>
            </div>
        </section>

        <section id="analyse" class="py-16 bg-white rounded-2xl">
            <h2 class="text-4xl font-bold text-center mb-4 text-gray-800">Analyse Globale des Frictions et Synergies</h2>
            <p class="max-w-3xl mx-auto text-lg text-gray-600 mb-12 text-center">
                Les problèmes ne sont pas isolés. Cette analyse agrégée révèle des points de friction systémiques et des synergies fortes entre processus, justifiant une approche de solution centralisée et réutilisable.
            </p>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-x-12 gap-y-16 items-start">
                <div class="w-full">
                    <h3 class="text-2xl font-bold text-center mb-4 text-gray-700">Priorités d'Automatisation</h3>
                    <div class="chart-container">
                        <canvas id="priorityChart"></canvas>
                    </div>
                    <div id="priority-legend" class="mt-4 px-2"></div>
                </div>
                <div class="w-full">
                    <h3 class="text-2xl font-bold text-center mb-4 text-gray-700">Analyse des Frictions Courantes</h3>
                    <p class="text-sm text-center text-gray-500 mb-4 -mt-2">La taille des bulles indique la fréquence ; la hauteur indique l'impact.</p>
                     <div class="chart-container" style="max-width: 600px; height: 350px;">
                        <canvas id="painPointChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="mt-20">
                 <h3 class="text-2xl font-bold text-center mb-4 text-gray-800">Tableau Interactif des Synergies</h3>
                 <p class="max-w-3xl mx-auto text-md text-gray-600 mb-8 text-center">
                    Survolez le tableau pour explorer les synergies. Une couleur intense indique une forte similarité. L'infobulle donne le pourcentage exact et les en-têtes sont mis en évidence pour une meilleure lisibilité.
                </p>
                <div id="interactive-table-container" class="overflow-x-auto p-4"></div>
            </div>
        </section>
        
        <section id="solution" class="py-24">
            <h2 class="text-4xl font-bold text-center mb-4 text-gray-800">Les Pôles de la Solution d'Automatisation</h2>
            <p class="max-w-4xl mx-auto text-lg text-gray-600 mb-12 text-center">
               La stratégie d'automatisation s'articule autour de trois pôles complémentaires. Cliquez sur chaque pôle pour explorer les solutions technologiques et leurs métriques comparatives.
            </p>
            <div class="grid lg:grid-cols-3 gap-8 mb-8">
                <!-- Pole 1 Trigger -->
                <div id="pole-1" class="pole-card active bg-white rounded-lg p-6 shadow-md cursor-pointer">
                    <div class="flex items-center mb-4">
                        <span class="text-4xl mr-4">🧠</span>
                        <h3 class="text-2xl font-bold" style="color: var(--secondary-color);">Synthèse & Exploration</h3>
                    </div>
                    <p class="text-sm text-gray-600">Outils pour interroger et synthétiser de grands volumes de documents. Idéal pour l'analyse initiale et la recherche d'informations.</p>
                </div>
                <!-- Pole 2 Trigger -->
                <div id="pole-2" class="pole-card bg-white rounded-lg p-6 shadow-md cursor-pointer">
                    <div class="flex items-center mb-4">
                        <span class="text-4xl mr-4">⚙️</span>
                        <h3 class="text-2xl font-bold" style="color: var(--secondary-color);">Extraction & Structuration</h3>
                    </div>
                    <p class="text-sm text-gray-600">Systèmes d'agents pour extraire les données des documents et les transformer en informations exploitables dans une base de données.</p>
                </div>
                <!-- Pole 3 Trigger -->
                <div id="pole-3" class="pole-card bg-white rounded-lg p-6 shadow-md cursor-pointer">
                    <div class="flex items-center mb-4">
                        <span class="text-4xl mr-4">✨</span>
                        <h3 class="text-2xl font-bold" style="color: var(--secondary-color);">Génération de Documents</h3>
                    </div>
                    <p class="text-sm text-gray-600">Agents spécialisés pour créer automatiquement des rapports Word, des présentations PPT et des fichiers Excel à partir des données structurées.</p>
                </div>
            </div>

            <!-- Details for Pole 1 -->
            <div id="pole-1-details" class="solution-details show">
                <div class="p-8 bg-gray-50 rounded-lg border">
                    <h4 class="text-2xl font-bold text-center mb-8" style="color: var(--secondary-color);">Comparatif : Outils de Synthèse et d'Exploration</h4>
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <div class="bg-white p-6 rounded-lg shadow-md flex flex-col">
                            <img src="google-notebooklm.png" alt="Interface de NotebookLM" class="rounded-md mb-4 h-40 object-cover">
                            <h5 class="solution-title text-xl mb-2">NotebookLM</h5>
                            <p class="text-sm text-gray-500 mb-4 flex-grow">Idéal pour l'exploration rapide et l'analyse individuelle de documents par un utilisateur unique.</p>
                            <dl class="solution-table space-y-3 text-sm">
                                <dt>Besoin matériel</dt><dd>Non (Service SaaS)</dd>
                                <dt>Coût</dt><dd>Usage de base gratuit. Pour une intégration API (Gemini 1.5 Pro), estimer environ <strong>1€ à 5€</strong> pour analyser un corpus de plusieurs centaines de pages.</dd>
                                <dt>Fiabilité & Contrôle</dt><dd>Élevée pour la recherche factuelle, car il cite ses sources. Le contrôle sur le modèle d'IA est limité.</dd>
                                <dt>Scalabilité</dt><dd>Très Élevée (gérée par Google).</dd>
                            </dl>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md flex flex-col">
                            <img src="anythinhllm.png" alt="Interface de AnythingLLM" style="display:block;margin:0 auto 1rem auto;padding:0.5rem;max-width:400px;max-height:600px;object-fit:contain;box-shadow:0 2px 8px rgba(0,0,0,0.04);">
                            <h5 class="solution-title text-xl mb-2">AnythingLLM</h5>
                            <p class="text-sm text-gray-500 mb-4 flex-grow">Solution d'entreprise, open-source et auto-hébergée pour un "chat" collaboratif et sécurisé avec les documents.</p>
                            <dl class="solution-table space-y-3 text-sm">
                                <dt>Besoin matériel</dt><dd>Serveur/VM avec au moins <strong> 4Go RAM, 2 vCPU.</strong> GPU (ex: NVIDIA RTX 3060) recommandé pour héberger le LLM.</dd>
                                <dt>Coût</dt><dd>Coût du serveur <strong>(~20€-100€/mois)</strong> + coût des appels API (OpenAI, Azure) ou amortissement du GPU.</dd>
                                <dt>Fiabilité & Contrôle</dt><dd>Très élevés. Contrôle total sur les modèles, les données (en interne) et la gestion des accès.</dd>
                                <dt>Scalabilité</dt><dd>Dépend de l'infrastructure serveur mise en place.</dd>
                            </dl>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md flex flex-col">
                            <img src="https://privategpt.io/screenshot.png" alt="Interface de PrivateGPT" class="rounded-md mb-4 h-40 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/600x400/2D3748/FFFFFF?text=PrivateGPT';">
                            <h5 class="solution-title text-xl mb-2">PrivateGPT</h5>
                            <p class="text-sm text-gray-500 mb-4 flex-grow">Conçu pour une confidentialité absolue. Toutes les opérations s'exécutent localement, aucune donnée ne quitte la machine.</p>
                            <dl class="solution-table space-y-3 text-sm">
                                <dt>Besoin matériel</dt><dd>PC puissant avec GPU NVIDIA (<strong> RTX 3060+ avec 8Go+ VRAM</strong>) et <strong>16Go+ RAM.</strong></dd>
                                <dt>Coût</dt><dd>Coût d'acquisition du matériel (<strong>estimé 600€-1100€</strong>). Pas de coût récurrent d'API.</dd>
                                <dt>Fiabilité & Contrôle</dt><dd>Contrôle maximal sur la confidentialité. Fiabilité des réponses dépendante des modèles locaux.</dd>
                                <dt>Scalabilité</dt><dd>Faible, limitée à une seule machine.</dd>
                            </dl>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Details for Pole 2 -->
            <div id="pole-2-details" class="solution-details">
                <div class="p-8 bg-gray-50 rounded-lg border">
                    <h4 class="text-2xl font-bold text-center mb-8" style="color: var(--secondary-color);">Pôle 2 : Extraction & Structuration de Données</h4>
                    <div class="grid lg:grid-cols-2 gap-8 items-center">
                        <div class="solution-table space-y-4">
                            <div><dt>Difficulté d'automatisation</dt><dd>Forte</dd></div>
                            <div><dt>Gain de temps</dt><dd>Élevé</dd></div>
                            <div><dt>Fréquence</dt><dd>Récurrente</dd></div>
                            <div>
                                <dt>Solution</dt>
                                <dd>Système d'agent IA sur <span class="font-bold text-teal-600">n8n</span> ou <span class="font-bold text-teal-600">Make</span>, orchestrant des services d'IA externes pour transformer les documents bruts en données structurées.</dd>
                            </div>
                            <div>
                                <dt>Besoin Matériel</dt>
                                <dd>
                                    <ul class="list-disc pl-5 mt-1">
                                        <li><b class="text-gray-600">Cloud :</b> Aucun.</li>
                                        <li><b class="text-gray-600">Auto-hébergé :</b> Serveur/VM avec au moins <strong> 2 vCPU, 4 Go RAM, 40 Go disque</strong> pour une instance n8n stable.</li>
                                    </ul>
                                </dd>
                            </div>
                            <div>
                                <dt>Coût</dt>
                                <dd>
                                    <ul class="list-disc pl-5 mt-1">
                                        <li><b class="text-gray-600">Financier :</b> Licence plateforme (n8n Cloud dès <strong>20€/mois</strong>, Make dès <strong>9€/mois</strong>) + coût API IA (ex: Azure AI <strong>~1,50€/1000 pages</strong>) + hébergement si applicable. Ou Plateforme Self Host n8n  (<strong> ex: Hostinger  à 6.99€/mois </strong>). Ou en encore Licence Communautiare Self Host gratuit (mimimum réquis<strong> PC 16 Go+ RAM  </strong>)</li>
                                        <li><b class="text-gray-600">Technique :</b> Développement et maintenance des workflows.</li>
                                    </ul>
                                </dd>
                            </div>
                            <div>
                                <dt>Fiabilité & Scalabilité</dt>
                                <dd>
                                    <ul class="list-disc pl-5 mt-1">
                                         <li><b class="text-gray-600">Fiabilité :</b> Très élevée après entraînement et mise en place de boucles de validation humaine.</li>
                                         <li><b class="text-gray-600">Scalabilité :</b> Très élevée, particulièrement avec les versions Cloud.</li>
                                    </ul>
                                </dd>
                            </div>
                        </div>
                        <div class="n8n-architecture relative p-4" id="n8n-diagram-2">
                           <svg class="absolute top-0 left-0 w-full h-full" id="n8n-svg-2"></svg>
                           <div class="n8n-col">
                               <div id="node-2-1" class="n8n-node has-tooltip"> Déclencheur de workflow<div class="tooltip-content">Déclenche le workflow après un clique de démarrage.</div></div>
                               <div id="node-2-2" class="n8n-node has-tooltip">📋 Requête<div class="tooltip-content">Lance le processus à partir d'une requête manuellement saisir dans un espace "Chat".</div></div>
                           </div>
                           <div class="n8n-col">
                                <div id="node-2-3" class="n8n-node n8n-node-main has-tooltip">
                                   <img src="logo_n8n2x.png" class="mx-auto mb-2 rounded-full">Orchestrateur n8n<div class="tooltip-content">Le workflow principal qui gère la logique, les conditions et appelle les agents spécialisés.</div>
                                </div>
                           </div>
                           <div class="n8n-col">
                               <div id="node-2-4" class="n8n-node n8n-node-agent has-tooltip">Agent d'Extraction (IDP)<div class="tooltip-content">Appelle des services comme Azure AI pour extraire les données brutes des PDF.</div></div>
                               <div id="node-2-5" class="n8n-node n8n-node-agent has-tooltip">Agent d'Analyse (LLM)<div class="tooltip-content">Utilise des modèles de langage pour comprendre et synthétiser le texte non structuré.</div></div>
                           </div>
                           <div class="n8n-col">
                               <div id="node-2-7" class="n8n-node has-tooltip">🗄️ Base de Données<div class="tooltip-content">Les données structurées sont stockées ici, créant une source de vérité unique.</div></div>
                           </div>
                       </div>
                    </div>
                </div>
            </div>

            <!-- Details for Pole 3 -->
            <div id="pole-3-details" class="solution-details">
                 <div class="p-8 bg-gray-50 rounded-lg border">
                    <h4 class="text-2xl font-bold text-center mb-8" style="color: var(--secondary-color);">Pôle 3 : Génération de Documents</h4>
                     <div class="grid lg:grid-cols-2 gap-8 items-center">
                        <div class="solution-table space-y-4">
                            <div><dt>Difficulté d'automatisation</dt><dd>Moyenne</dd></div>
                            <div><dt>Gain de temps</dt><dd>Élevé</dd></div>
                            <div><dt>Fréquence</dt><dd>Récurrente</dd></div>
                            <div>
                                <dt>Solution</dt>
                                <dd>Agents IA sur <span class="font-bold text-teal-600">n8n</span> ou <span class="font-bold text-teal-600">Make</span>, qui utilisent des scripts et des modèles pour générer dynamiquement des fichiers Word, PowerPoint, PDF et Excel à partir de données structurées.</dd>
                            </div>
                             <div>
                                <dt>Besoin Matériel</dt><dd>Non (la génération est logicielle et s'exécute sur la même infrastructure que la plateforme d'orchestration).</dd>
                            </div>
                            <div>
                                <dt>Coût</dt>
                                <dd>
                                    <ul class="list-disc pl-5 mt-1">
                                        <li><b class="text-gray-600">Financier :</b> Principalement inclus dans le coût de la plateforme (n8n/Make). Faible surcoût lié au temps de calcul.</li>
                                        <li><b class="text-gray-600">Technique :</b> Temps de développement pour la création des modèles de documents (Word, PPT, etc.) et pour l'écriture des scripts de génération de données.</li>
                                    </ul>
                                </dd>
                            </div>
                             <div>
                                <dt>Fiabilité & Scalabilité</dt>
                                <dd>
                                    <ul class="list-disc pl-5 mt-1">
                                         <li><b class="text-gray-600">Fiabilité :</b> Très élevée, car le processus est déterministe et se base sur des données déjà validées, éliminant les erreurs de copier-coller.</li>
                                         <li><b class="text-gray-600">Scalabilité :</b> Très élevée, capable de générer des centaines de documents en parallèle.</li>
                                    </ul>
                                </dd>
                            </div>
                        </div>
                        <div class="n8n-architecture relative p-4" id="n8n-diagram-3">
                             <svg class="absolute top-0 left-0 w-full h-full" id="n8n-svg-3"></svg>
                             <div class="n8n-col">
                                 <div id="node-3-1" class="n8n-node has-tooltip">🗄️ Base de Données<div class="tooltip-content">Les données structurées et validées sont la source pour la génération des documents.</div></div>
                             </div>
                             <div class="n8n-col">
                                  <div id="node-3-3" class="n8n-node n8n-node-main has-tooltip">
                                     <img src="logo_n8n2x.png" class="mx-auto mb-2 rounded-full">Orchestrateur n8n<div class="tooltip-content">Le workflow principal récupère les données et appelle l'agent de génération.</div>
                                  </div>
                             </div>
                             <div class="n8n-col">
                                 <div id="node-3-6" class="n8n-node n8n-node-agent has-tooltip">Agent de Génération<div class="tooltip-content">Utilise des scripts et des modèles pour créer des documents Word, PPT, Excel, etc.</div></div>
                             </div>
                             <div class="n8n-col">
                                 <div id="node-3-8" class="n8n-node has-tooltip">📄 Word / ✨ PPT<div class="tooltip-content">Les rapports et présentations finaux sont générés et sauvegardés ou envoyés.</div></div>
                             </div>
                         </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- New Section: Redaction Contrat -->
        <section id="redaction" class="py-24 bg-slate-100">
             <h2 class="text-4xl font-bold text-center mb-4 text-gray-800">Focus : Automatisation de la Rédaction de Contrats</h2>
             <div class="bg-white p-8 rounded-xl shadow-xl mt-8">
                 <div class="mb-6 border-b border-slate-300">
                    <nav class="flex space-x-4" aria-label="Tabs">
                        <button data-tab-content="defi" class="tab-button redaction-tab-button active font-medium py-3 px-4 border-b-2 border-transparent hover:border-slate-400 focus:outline-none">
                            Le Défi Actuel
                        </button>
                        <button data-tab-content="solutions" class="tab-button redaction-tab-button font-medium py-3 px-4 border-b-2 border-transparent hover:border-slate-400 focus:outline-none">
                            Panorama des Solutions
                        </button>
                        <button data-tab-content="ia" class="tab-button redaction-tab-button font-medium py-3 px-4 border-b-2 border-transparent hover:border-slate-400 focus:outline-none">
                            Rôle de l'IA
                        </button>
                    </nav>
                </div>
                <!-- Content for Redaction Tabs -->
                <div id="defi-content" class="redaction-tab-content active">
                    <h3 class="text-2xl font-semibold text-slate-700 mb-4">La Rédaction Manuelle : Un Processus Complexe et Risqué</h3>
                    <p class="text-slate-600 mb-6">La rédaction manuelle de contrats, en particulier pour les modèles volumineux, présente de multiples défis qui impactent l'efficacité opérationnelle et la gestion des risques.</p>
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-rose-50 p-6 rounded-lg shadow-md border-l-4 border-rose-500">
                            <h4 class="text-xl font-semibold text-rose-700 mb-2">⏱️ Processus Chronophage</h4>
                            <p class="text-slate-600">La complétion manuelle de documents volumineux et le transfert de données Excel vers Word sont extrêmement lents.</p>
                        </div>
                        <div class="bg-amber-50 p-6 rounded-lg shadow-md border-l-4 border-amber-500">
                            <h4 class="text-xl font-semibold text-amber-700 mb-2">⚠️ Risque d'Erreurs Élevé</h4>
                            <p class="text-slate-600">La saisie manuelle est sujette aux fautes de frappe, à l'utilisation d'informations obsolètes et aux incohérences.</p>
                        </div>
                        <div class="bg-sky-50 p-6 rounded-lg shadow-md border-l-4 border-sky-500">
                            <h4 class="text-xl font-semibold text-sky-700 mb-2">🧩 Complexité des Modèles</h4>
                            <p class="text-slate-600">Un modèle de plus de 100 pages implique une logique conditionnelle et un contenu dynamique importants.</p>
                        </div>
                    </div>
                </div>
                <div id="solutions-content" class="redaction-tab-content hidden">
                    <h3 class="text-2xl font-semibold text-slate-700 mb-4">Panorama des Solutions d'Automatisation de la Rédaction de Contrats</h3>
                    <p class="mb-6 text-slate-600">Voici les solutions les plus adaptées pour automatiser la rédaction de contrats, couvrant tous les besoins : logique conditionnelle, volumétrie, sécurité, personnalisation et intégration métier.</p>
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-teal-500 flex flex-col">
                            <h4 class="text-xl font-bold text-teal-700 mb-2">n8n + Docxtemplater</h4>
                            <p class="text-sm text-gray-600 mb-3 flex-grow">Automatisation avancée sur-mesure : extraction de données, logique conditionnelle, génération dynamique de contrats Word/PDF, gestion des modèles complexes (plus de 100 pages), intégration avec Excel, validation humaine, envoi automatique.</p>
                            <ul class="list-disc pl-5 text-xs text-gray-500 mb-2">
                                <li>100% personnalisable (workflows, modèles, scripts JS)</li>
                                <li>Gestion de la volumétrie et des cas complexes</li>
                                <li>Hébergement cloud ou interne (RGPD)</li>
                                <li>Coût : dès 0€ (self-host) ou 20€/mois (cloud)</li>
                            </ul>
                            <span class="tag tag-blue mt-2">Low-code / Sur-mesure</span>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-indigo-500 flex flex-col">
                            <h4 class="text-xl font-bold text-indigo-700 mb-2">Plumsail Documents</h4>
                            <p class="text-sm text-gray-600 mb-3 flex-grow">Plateforme SaaS spécialisée pour la génération de documents Word/PDF avec logique conditionnelle, tableaux dynamiques, intégration Power Automate, API REST, gestion des modèles volumineux.</p>
                            <ul class="list-disc pl-5 text-xs text-gray-500 mb-2">
                                <li>Interface graphique simple</li>
                                <li>Support des modèles Word complexes</li>
                                <li>Intégration facile avec Microsoft 365</li>
                                <li>Coût : dès 29$/mois</li>
                            </ul>
                            <span class="tag tag-blue mt-2">SaaS Spécialisé</span>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-purple-500 flex flex-col">
                            <h4 class="text-xl font-bold text-purple-700 mb-2">Microsoft Power Automate + Word Online</h4>
                            <p class="text-sm text-gray-600 mb-3 flex-grow">Automatisation native dans l'écosystème Microsoft : remplissage de modèles Word, gestion des flux d'approbation, intégration avec SharePoint, Teams, Excel. Idéal pour les contrats standards et la collaboration.</p>
                            <ul class="list-disc pl-5 text-xs text-gray-500 mb-2">
                                <li>Intégration profonde M365</li>
                                <li>Automatisation des validations et signatures</li>
                                <li>Limites sur la complexité des modèles (voir doc MS)</li>
                                <li>Coût : inclus dans M365 ou à partir de 12,60€/mois</li>
                            </ul>
                            <span class="tag tag-blue mt-2">Low-code / M365</span>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-green-500 flex flex-col">
                            <h4 class="text-xl font-bold text-green-700 mb-2">Conga Composer</h4>
                            <p class="text-sm text-gray-600 mb-3 flex-grow">Solution d'entreprise pour la génération de contrats dynamiques, logique conditionnelle avancée, intégration Salesforce, gestion de la volumétrie, automatisation des workflows contractuels.</p>
                            <ul class="list-disc pl-5 text-xs text-gray-500 mb-2">
                                <li>Idéal pour les organisations</li>
                                <li>Support des modèles Word complexes</li>
                                <li>Automatisation bout-en-bout</li>
                                <li>Coût : sur devis</li>
                            </ul>
                            <span class="tag tag-blue mt-2">Entreprise</span>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-pink-500 flex flex-col">
                            <h4 class="text-xl font-bold text-pink-700 mb-2">ClauseBase</h4>
                            <p class="text-sm text-gray-600 mb-3 flex-grow">Outil SaaS spécialisé pour la rédaction intelligente de contrats, bibliothèque de clauses, logique conditionnelle, génération multilingue, collaboration juridique.</p>
                            <ul class="list-disc pl-5 text-xs text-gray-500 mb-2">
                                <li>Bibliothèque de clauses réutilisables</li>
                                <li>Génération intelligente et multilingue</li>
                                <li>Collaboration et versioning</li>
                                <li>Coût : sur devis</li>
                            </ul>
                            <span class="tag tag-blue mt-2">SaaS Juridique</span>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-yellow-500 flex flex-col">
                            <h4 class="text-xl font-bold text-yellow-700 mb-2">AnythingLLM + Docxtemplater</h4>
                            <p class="text-sm text-gray-600 mb-3 flex-grow">Pour les besoins de confidentialité maximale : solution open-source auto-hébergée, génération de contrats à partir de prompts, intégration Docxtemplater, contrôle total sur les données et modèles.</p>
                            <ul class="list-disc pl-5 text-xs text-gray-500 mb-2">
                                <li>Confidentialité totale (données internes)</li>
                                <li>Personnalisation avancée</li>
                                <li>Support des modèles volumineux</li>
                                <li>Coût : serveur + open-source</li>
                            </ul>
                            <span class="tag tag-blue mt-2">Open-source / Local</span>
                        </div>
                    </div>
                    <p class="mt-8 text-sm text-slate-500">Pour un maximum de contrôle et d'évolutivité, la combinaison n8n + Docxtemplater est la plus flexible. Pour un usage M365 natif, Power Automate est idéal. Pour la collaboration juridique, ClauseBase ou Conga sont à privilégier.</p>
                </div>
                <div id="ia-content" class="redaction-tab-content hidden">
                    <!-- Placeholder for AI role content, you can copy from the original section if needed -->
                     <h3 class="text-2xl font-semibold text-slate-700 mb-4">Le Rôle Stratégique de l'IA dans la Rédaction</h3>
                    <p>L'IA peut aider à l'extraction de données, la recommandation de clauses, et l'analyse de risques...</p>
                </div>
             </div>
        </section>
    </main>

    <footer class="text-white text-center py-6" style="background-color: var(--secondary-color);">
        <p>&copy;2025 JRBC - Analyse des processus métier</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            
            const processData = [
                { id: 1, title: "I. Audit de reversement", category: "Audit", priority: "Moyenne", desc: "Contrôle de la conformité des données transmises en fin de contrat.", workflow: ["Collecte des documents", "Vérification et Contrôle Qualité", "Saisie et Structuration des Données", "Rédaction du Rapport"], painPoints: ["Extraction manuelle de données", "Risque d'erreurs dans le rapport"] },
                { id: 2, title: "II. Transfert de compétence", category: "Étude", priority: "Haute", desc: "État des lieux complet lors d'un transfert de compétence entre entités.", workflow: ["Collecte des Documents Volumineux", "Mise à jour des fichiers Excel", "Tâches de Consolidation", "Rédaction des Rapports et PPT"], painPoints: ["Qualité médiocre des scans", "Processus très chronophage", "Risque élevé d'erreurs de transcription"] },
                { id: 3, title: "IV. Suivi de Contrat COPIL", category: "Gestion", priority: "Haute", desc: "Suivi régulier des obligations contractuelles pour les comités de pilotage.", workflow: ["Lecture du Contrat", "Saisie des Échéances", "Calcul des Pénalités", "Préparation de l'Ordre du Jour"], painPoints: ["Charge de travail importante", "Risque d'erreurs financières", "Manque de réactivité"] },
                { id: 4, title: "IX. Analyse des Offres (RAO)", category: "Analyse", priority: "Très Haute", desc: "Analyse comparative complexe d'offres dans le cadre d'appels d'offres.", workflow: ["Analyse des Offres", "Consolidation des Données", "Rédaction de la Synthèse", "Préparation du Rapport Final"], painPoints: ["Analyse subjective et non standardisée", "Manque de profondeur analytique possible", "Risque de biais", "Temps de décision allongé"] },
                { id: 5, title: "XI/XII. Chiffrage & Simulation", category: "Étude", priority: "Très Haute", desc: "Modélisation financière de scénarios et de projections budgétaires.", workflow: ["Collecte des Données d'Entrée", "Construction des Modèles", "Exécution des Simulations", "Consolidation des Résultats"], painPoints: ["Dépendance à des tableurs Excel complexes", "Risque élevé d'erreurs de modélisation"] },
                { id: 6, title: "III. Rapport Annuel (RPQS)", category: "Étude", priority: "Moyenne", desc: "Rédaction du Rapport Annuel sur le Prix et la Qualité du Service.", workflow: ["Collecte des Questionnaires", "Analyse des Rapports Délégataire", "Consolidation Multi-sources", "Rédaction du Rapport et PPT"], painPoints: ["Processus long et répétitif", "Consolidation manuelle sujette à oublis"] },
                 { id: 7, title: "VIII. Suivi de contrat (début)", category: "Gestion", priority: "Haute", desc: "Analyse initiale d'un nouveau contrat pour mettre en place le suivi.", workflow: ["Lecture Exhaustive du Contrat", "Extraction des Obligations", "Création de la Grille de Suivi"], painPoints: ["Lecture manuelle de documents très longs et denses", "Tâche fastidieuse et chronophage"] }
            ];

            const grid = document.getElementById('process-grid');
            const detailView = document.getElementById('process-detail');
            const closeDetailBtn = document.getElementById('close-detail');

            function getPriorityClass(priority) {
                switch (priority) {
                    case 'Très Haute': return 'tag-red';
                    case 'Haute': return 'tag-orange';
                    case 'Moyenne': return 'tag-blue';
                    default: return 'bg-gray-200 text-gray-800';
                }
            }

            function getCategoryClass(category) {
                 switch (category) {
                    case 'Audit': return 'bg-red-100 text-red-800';
                    case 'Gestion': return 'bg-yellow-100 text-yellow-800';
                    case 'Analyse': return 'bg-purple-100 text-purple-800';
                    case 'Étude': return 'bg-green-100 text-green-800';
                    default: return 'bg-gray-100 text-gray-800';
                }
            }

            function renderGrid(filter = 'all') {
                grid.innerHTML = '';
                const filteredData = (filter === 'all') ? processData : processData.filter(p => p.category.startsWith(filter.substring(0,5)));

                filteredData.forEach(p => {
                    const card = document.createElement('div');
                    card.className = 'card bg-white p-6 rounded-xl shadow-md cursor-pointer';
                    card.dataset.id = p.id;
                    card.innerHTML = `
                        <h3 class="font-bold text-lg text-gray-800 mb-2">${p.title}</h3>
                        <p class="text-gray-600 text-sm mb-4 h-10">${p.desc}</p>
                        <div class="flex justify-between items-center">
                            <span class="tag ${getCategoryClass(p.category)}">${p.category}</span>
                            <span class="tag ${getPriorityClass(p.priority)}">Priorité ${p.priority}</span>
                        </div>
                    `;
                    card.addEventListener('click', () => showDetail(p.id));
                    grid.appendChild(card);
                });
            }

            const workflowIcons = {
                "collecte": "<div class='icon-scan'></div>",
                "lecture": "<div class='icon-scan'></div>",
                "extraction": "<div class='icon-scan'></div>",
                "analyse": "<div class='icon-scan'></div>",
                "vérification": "<div class='icon-check'><div class='checkmark-kick'></div><div class='checkmark-stem'></div></div>",
                "contrôle": "<div class='icon-check'><div class='checkmark-kick'></div><div class='checkmark-stem'></div></div>",
                "saisie": "<div class='icon-grid'>"+"<div class='cell'></div>".repeat(9)+"</div>",
                "structuration": "<div class='icon-grid'>"+"<div class='cell'></div>".repeat(9)+"</div>",
                "consolidation": "<div class='icon-grid'>"+"<div class='cell'></div>".repeat(9)+"</div>",
                "création": "<div class='icon-grid'>"+"<div class='cell'></div>".repeat(9)+"</div>",
                "rédaction": "<div class='icon-write'></div>",
                "préparation": "<div class='icon-write'></div>",
                "simulation": "<div class='icon-graph'><div class='bar'></div><div class='bar'></div><div class='bar'></div></div>",
                "calcul": "<div class='icon-graph'><div class='bar'></div><div class='bar'></div><div class='bar'></div></div>",
                "construction": "<div class='icon-graph'><div class='bar'></div><div class='bar'></div><div class='bar'></div></div>",
            };

            function getWorkflowIcon(stepText) {
                const text = stepText.toLowerCase();
                for (const key in workflowIcons) {
                    if (text.includes(key)) {
                        return workflowIcons[key];
                    }
                }
                return "<div class='icon-write'></div>"; // Default icon
            }


            function showDetail(id) {
                const process = processData.find(p => p.id === id);
                if (!process) return;

                document.getElementById('detail-title').textContent = process.title;
                document.getElementById('detail-description').textContent = process.desc;
                
                const categorySpan = document.getElementById('detail-category');
                categorySpan.textContent = process.category;
                categorySpan.className = `tag ${getCategoryClass(process.category)}`;

                const prioritySpan = document.getElementById('detail-priority');
                prioritySpan.textContent = `Priorité ${process.priority}`;
                prioritySpan.className = `tag ${getPriorityClass(process.priority)}`;

                // Animated Workflow
                const workflowContainer = document.getElementById('detail-workflow');
                workflowContainer.innerHTML = ''; // Clear previous content

                process.workflow.forEach((step, index) => {
                    const stepEl = document.createElement('div');
                    stepEl.className = 'workflow-step';
                    stepEl.innerHTML = `
                        <div class="workflow-icon-container">
                            ${getWorkflowIcon(step)}
                        </div>
                        <span>${step}</span>
                    `;
                    workflowContainer.appendChild(stepEl);

                    if (index < process.workflow.length - 1) {
                        const arrowEl = document.createElement('div');
                        arrowEl.className = 'workflow-arrow';
                        arrowEl.innerHTML = '↓';
                        workflowContainer.appendChild(arrowEl);
                    }
                });
                
                // Animate the steps
                setTimeout(() => {
                    const steps = workflowContainer.querySelectorAll('.workflow-step');
                    const arrows = workflowContainer.querySelectorAll('.workflow-arrow');
                    steps.forEach((step, index) => {
                        setTimeout(() => {
                            step.classList.add('visible');
                            if (arrows[index]) {
                                arrows[index].classList.add('visible');
                            }
                        }, index * 300); 
                    });
                }, 100);


                const painpointsList = document.getElementById('detail-painpoints');
                painpointsList.innerHTML = process.painPoints.map(pp => `<li>${pp}</li>`).join('');

                detailView.classList.remove('hidden');
                detailView.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }

            closeDetailBtn.addEventListener('click', () => {
                detailView.classList.add('hidden');
            });
            
            const filterButtons = document.querySelectorAll('.filter-btn');
            filterButtons.forEach(button => {
                button.addEventListener('click', () => {
                    filterButtons.forEach(btn => {
                        btn.classList.remove('active');
                        btn.style.backgroundColor = '#E5E7EB'; // gray-200
                        btn.style.color = '#374151'; // gray-800
                    });
                    button.classList.add('active');
                    button.style.backgroundColor = 'var(--secondary-color)';
                    button.style.color = 'white';
                    renderGrid(button.dataset.filter);
                     if (!detailView.classList.contains('hidden')) {
                        detailView.classList.add('hidden');
                    }
                });
            });

            renderGrid();

            const priorityColors = {
                'Très Haute': '#DC2626',
                'Haute': '#F59E0B',
                'Moyenne': '#3B82F6'
            };
            
            const priorityData = {
                'Très Haute': { count: 0, processes: [] },
                'Haute': { count: 0, processes: [] },
                'Moyenne': { count: 0, processes: [] }
            };

            processData.forEach(p => {
                if (priorityData[p.priority]) {
                    priorityData[p.priority].count++;
                    priorityData[p.priority].processes.push(p.title);
                }
            });

            const priorityChartCtx = document.getElementById('priorityChart').getContext('2d');
            new Chart(priorityChartCtx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(priorityData),
                    datasets: [{
                        data: Object.values(priorityData).map(d => d.count),
                        backgroundColor: Object.values(priorityColors),
                        borderColor: '#F9FAFB',
                        borderWidth: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    }
                }
            });

            const legendContainer = document.getElementById('priority-legend');
            legendContainer.innerHTML = Object.keys(priorityData).map(key => `
                <div class="mb-3">
                    <div class="flex items-center mb-1">
                        <span class="w-4 h-4 rounded-full mr-2" style="background-color: ${priorityColors[key]}"></span>
                        <h4 class="font-bold text-md" style="color: var(--secondary-color);">${key} (${priorityData[key].count})</h4>
                    </div>
                    <ul class="list-disc list-inside pl-4 text-xs text-gray-600">
                        ${priorityData[key].processes.map(proc => `<li>${proc}</li>`).join('')}
                    </ul>
                </div>
            `).join('');

            const painPointPriorityMap = { 'Très Haute': 3, 'Haute': 2, 'Moyenne': 1 };
            const painPointData = {};

            processData.forEach(p => {
                p.painPoints.forEach(pp => {
                    if (!painPointData[pp]) {
                        painPointData[pp] = { frequency: 0, impactScore: 0 };
                    }
                    painPointData[pp].frequency++;
                    painPointData[pp].impactScore += painPointPriorityMap[p.priority] || 0;
                });
            });

            const bubbleData = Object.keys(painPointData).map((key, index) => ({
                label: key,
                x: (index % 4) + Math.random() * 0.5,
                y: painPointData[key].impactScore / painPointData[key].frequency,
                r: painPointData[key].frequency * 6
            }));

            const painPointChartCtx = document.getElementById('painPointChart').getContext('2d');
            new Chart(painPointChartCtx, {
                type: 'bubble',
                data: {
                    datasets: [{
                        label: 'Points de Friction',
                        data: bubbleData,
                        backgroundColor: 'rgba(0, 169, 157, 0.7)',
                        borderColor: 'rgba(0, 169, 157, 1)',
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const data = context.raw;
                                    return `${data.label}: ${data.r/6} processus affecté(s)`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            title: { display: true, text: 'Impact (Priorité moyenne)' },
                            min: 0,
                            max: 3.5
                        },
                        x: {
                            display: false
                        }
                    }
                }
            });


            const tableContainer = document.getElementById('interactive-table-container');
            const similarityData = {
                labels: ["I. Audit", "II. Transfert", "III. RPQS", "IV. Suivi COPIL", "VIII. Suivi Début", "IX. RAO", "X. Audit Tech.", "XI/XII. Chiffrage"],
                matrix: [
                    [1.00, 0.29, 0.57, 0.86, 0.86, 0.43, 0.71, 0.29],
                    [0.29, 1.00, 0.43, 0.29, 0.29, 0.43, 0.43, 0.57],
                    [0.57, 0.43, 1.00, 0.57, 0.57, 0.71, 0.43, 0.43],
                    [0.86, 0.29, 0.57, 1.00, 1.00, 0.57, 0.71, 0.29],
                    [0.86, 0.29, 0.57, 1.00, 1.00, 0.57, 0.71, 0.29],
                    [0.43, 0.43, 0.71, 0.57, 0.57, 1.00, 0.43, 0.57],
                    [0.71, 0.43, 0.43, 0.71, 0.71, 0.43, 1.00, 0.43],
                    [0.29, 0.57, 0.43, 0.29, 0.29, 0.57, 0.43, 1.00]
                ]
            };

            function createInteractiveTable() {
                tableContainer.innerHTML = '';
                const table = document.createElement('table');
                table.className = 'interactive-table';

                const thead = table.createTHead();
                const headerRow = thead.insertRow();
                const emptyTh = document.createElement('th');
                headerRow.appendChild(emptyTh);
                
                similarityData.labels.forEach((label, i) => {
                    const th = document.createElement('th');
                    th.className = 'col-header';
                    th.id = `col-header-${i}`;
                    th.textContent = label.replace(/ *\([^)]*\) */g, "");
                    headerRow.appendChild(th);
                });

                const tbody = table.createTBody();
                similarityData.matrix.forEach((row, i) => {
                    const tr = tbody.insertRow();
                    const rowHeader = document.createElement('th');
                    rowHeader.id = `row-header-${i}`;
                    rowHeader.textContent = similarityData.labels[i].replace(/ *\([^)]*\) */g, "");
                    tr.appendChild(rowHeader);
                    
                    row.forEach((value, j) => {
                        const td = tr.insertCell();
                        td.dataset.rowIndex = i;
                        td.dataset.colIndex = j;
                        
                        const primaryColor = '0, 169, 157'; // Teal
                        td.style.backgroundColor = `rgba(${primaryColor}, ${value * 0.8})`;
                        td.innerHTML = `<span class="tooltip">${Math.round(value * 100)}%</span>`;
                    });
                });

                tableContainer.appendChild(table);

                tbody.addEventListener('mouseover', (e) => {
                    if (e.target.tagName === 'TD') {
                        const rowIndex = e.target.dataset.rowIndex;
                        const colIndex = e.target.dataset.colIndex;
                        document.getElementById(`row-header-${rowIndex}`).classList.add('highlight-strong');
                        document.getElementById(`col-header-${colIndex}`).classList.add('highlight-strong');
                        e.target.classList.add('highlight-weak');
                    }
                });

                tbody.addEventListener('mouseout', (e) => {
                    if (e.target.tagName === 'TD') {
                        const rowIndex = e.target.dataset.rowIndex;
                        const colIndex = e.target.dataset.colIndex;
                        document.getElementById(`row-header-${rowIndex}`).classList.remove('highlight-strong');
                        document.getElementById(`col-header-${colIndex}`).classList.remove('highlight-strong');
                        e.target.classList.remove('highlight-weak');
                    }
                });
            }
            
            createInteractiveTable();

            // --- New Solution Section Logic ---
            const poleCards = document.querySelectorAll('.pole-card');
            const solutionDetails = document.querySelectorAll('.solution-details');

            function drawN8nArrows(svgId, diagramId) {
                const svg = document.getElementById(svgId);
                if(!svg) return;
                svg.innerHTML = ''; // Clear previous arrows
                const diagram = document.getElementById(diagramId);
                 if(!diagram) return;
                const containerRect = diagram.getBoundingClientRect();
                
                let connections;
                if (diagramId === 'n8n-diagram-2') {
                    connections = [
                        ['node-2-1', 'node-2-3'], ['node-2-2', 'node-2-3'],
                        ['node-2-3', 'node-2-4'], ['node-2-3', 'node-2-5'],
                        ['node-2-4', 'node-2-7'], ['node-2-5', 'node-2-7']
                    ];
                } else {
                     connections = [
                        ['node-3-1', 'node-3-3'],
                        ['node-3-3', 'node-3-6'],
                        ['node-3-6', 'node-3-8']
                    ];
                }

                connections.forEach(conn => {
                    const startNode = document.getElementById(conn[0]);
                    const endNode = document.getElementById(conn[1]);
                    if(!startNode || !endNode) return;
                    
                    const startRect = startNode.getBoundingClientRect();
                    const endRect = endNode.getBoundingClientRect();

                    const startX = (startRect.right - containerRect.left);
                    const startY = startRect.top + startRect.height / 2 - containerRect.top;
                    const endX = (endRect.left - containerRect.left);
                    const endY = endRect.top + endRect.height / 2 - containerRect.top;
                    
                    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                    const d = `M ${startX} ${startY} C ${startX + 60} ${startY}, ${endX - 60} ${endY}, ${endX} ${endY}`;
                    path.setAttribute('d', d);
                    path.setAttribute('stroke', 'var(--secondary-color)');
                    path.setAttribute('stroke-width', '2');
                    path.setAttribute('fill', 'none');
                    path.setAttribute('marker-end', 'url(#arrowhead)');
                    
                    const pathLength = path.getTotalLength();
                    path.style.strokeDasharray = pathLength;
                    path.style.strokeDashoffset = pathLength;
                    path.style.animation = `draw-line 0.8s ease-out forwards ${Math.random() * 0.4}s`;
                    path.style.animationName = 'draw-line'; // Ensure animation name is set for CSS keyframes

                    svg.appendChild(path);
                });
            }
            
            // Define arrowhead marker for SVGs and keyframe animation
            const defs = `
                <defs>
                    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="var(--secondary-color)" />
                    </marker>
                </defs>
                <style>
                    @keyframes draw-line { to { stroke-dashoffset: 0; } }
                </style>
            `;
            document.body.insertAdjacentHTML('beforeend', `<svg style="width:0;height:0;position:absolute;">${defs}</svg>`);

            poleCards.forEach(card => {
                card.addEventListener('click', () => {
                    const targetId = card.id + '-details';
                    
                    poleCards.forEach(c => c.classList.remove('active'));
                    card.classList.add('active');

                    solutionDetails.forEach(detail => {
                        if (detail.id === targetId) {
                            detail.classList.add('show');
                            const diagramId = 'n8n-diagram-' + targetId.charAt(5);
                            const svgId = 'n8n-svg-' + targetId.charAt(5);
                             if (document.getElementById(diagramId)) {
                                setTimeout(() => drawN8nArrows(svgId, diagramId), 50);
                             }
                        } else {
                            detail.classList.remove('show');
                        }
                    });
                });
            });

            // Logic for the new Redaction section
            const redactionTabButtons = document.querySelectorAll('.redaction-tab-button');
            const redactionTabContents = document.querySelectorAll('.redaction-tab-content');

            redactionTabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabId = button.dataset.tabContent;

                    redactionTabButtons.forEach(btn => btn.classList.remove('active', 'border-indigo-500', 'text-indigo-600', 'bg-indigo-100'));
                    button.classList.add('active', 'border-indigo-500', 'text-indigo-600', 'bg-indigo-100');

                    redactionTabContents.forEach(content => {
                        if (content.id === tabId + '-content') {
                            content.classList.add('active');
                            content.classList.remove('hidden');
                        } else {
                            content.classList.remove('active');
                            content.classList.add('hidden');
                        }
                    });
                });
            });
        });
    </script>

</body>
</html>
